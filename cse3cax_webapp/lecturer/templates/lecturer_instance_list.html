<div class="container-fluid my-4">
    <div class="table-responsive">
        <table class="table table-bordered text-center">
            <thead>
                <tr>
                    <th style="width: 100px;"></th>
                    {% for year in years %}
                        <th colspan="12">{{ year }}</th>
                    {% endfor %}
                </tr>
                <tr>
                    <th style="width: 100px;"></th>
                    {% for year in years %}
                        {% for month_name in months.values %}
                            <th style="width: 100px;">{{ month_name }}</th>
                        {% endfor %}
                    {% endfor %}
                </tr>
            </thead>
            <tbody>
                {% for subject_instance in subject_instances_list %}
                    <tr>
                        <th style="width: 100px;">{{ subject_instance.subject_id }} {{ subject_instance.start_month }}/{{ subject_instance.start_year }}</th>
                        {% for year in years %}
                            {% for month_number, month_name in months.items %}
                                {% if year == subject_instance.start_year and month_number == subject_instance.start_month %}
                                <td colspan="3" class="position-relative table-success">
                                  <button class="btn btn-full"
                                          hx-get="{% url 'subject_instance_info' %}?instance_id={{ subject_instance.instance_id }}"
                                          hx-trigger="click"
                                          hx-target="#dialog"
                                          hx-swap="innerHTML">
                                      {{ subject_instance.subject_name }} {{ subject_instance.start_month }}/{{ subject_instance.start_year }}
                                  </button>
                              </td>
                                {% elif year == subject_instance.start_year and month_number > subject_instance.start_month and month_number < subject_instance.start_month|add:"3" %}
                                    <!-- Skip rendering for months covered by colspan -->
                                {% else %}
                                    <td></td>
                                {% endif %}
                            {% endfor %}
                        {% endfor %}
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Modal container -->
    <div id="modal-container"></div>
</div>

<style>
/* Make the button cover the whole cell */
.btn-full {
    width: 100%;
    height: 100%;
    border: none;
    position: absolute;
    top: 0;
    left: 0;
}

/* Add hover effect on the parent table cell */
.table-success:hover {
    background-color: #d4eefa;
}
</style>